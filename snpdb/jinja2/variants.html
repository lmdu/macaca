{% extends "base.html" %}
{% block main %}
<div class="ui segment">
	<div class="ui chromosome circular labels">
		Chromo:
		<a class="ui label {% if paras['chrom']==0 %} brown {% endif %}" data-num="0">All</a>
		{% for c in chromos %}
		<a class="ui label {% if paras['chrom']==c.id %} brown {% endif %}" data-num="{{c.id}}">{{c.name}}</a>
		{% endfor %}
	</div>

	<div class="ui individual circular labels">
		Macaca:
		<a class="ui label {% if paras['indiv']==0 %} brown {% endif %}" data-num="0">All</a>
		{% for s in species %}
		<a class="ui label {% if paras['indiv']==s.id %} brown {% endif %}" data-num="{{s.id}}">{{s.code}}</a>
		{% endfor %}
	</div>

	{% set features=["All", "CDS", "3'UTR", "5'UTR", "Exon", "Intron", "Synonymous", "Non-synonymous"] %}

	<div class="ui feature circular labels">
		Feature:
		{% for f in features %}
		<a class="ui label {% if paras['feat']==loop.index0 %} brown {% endif %}" data-num="{{loop.index0}}">{{ f }}</a>
		{% endfor %}
	</div>
</div>

<div class="ui grid">
	<div class="eight wide column">
		<form action="{{ url('variants') }}" method="get" id="snps-filter">
			<input type="hidden" id="page" name="page" value="{{ paras['page'] }}">
			<input type="hidden" id="chromosome" name="chr" value="{{ paras['chrom'] }}">
			<input type="hidden" id="individual" name="indiv" value="{{ paras['indiv'] }}">
			<input type="hidden" id="feature" name="feat" value="{{ paras['feat'] }}">
		
			Show
			<select name="per" class="ui numperpage compact selection dropdown">
				{% set pages=[10, 25, 50, 100] %}
				{% for v in pages %}
				<option value="{{v}}" {% if paras['per']==v %} selected="selected" {% endif %}>{{v}}</option>
				{% endfor %}
			</select>
			entries
		</form>
	</div>

	<div class="right aligned eight wide column">
		<div class="ui basic segment">
			<div class="ui two horizontal statistic">
				<div class="statistic">
					<div class="value">{{ snps.paginator.count }}</div>
					<div class="label">SNPs</div>
				</div>
				<div class="statistic">
					<div class="value">{{ snps.paginator.num_pages }}</div>
					<div class="label">Pages</div>
				</div>
			</div>
		</div>
	</div>
</div>

<table class="ui celled table">
	<thead>
		<tr>
			<th>SNP ID</th>
			<th>Position</th>
			<th>Individual</th>
			<th>Reference</th>
			<th>Alteration</th>
			<th>Genotype</th>
		</tr>
	</thead>
	<tbody>
		{% for snp in snps %}
		<tr>
			<td><a href="{{ url('snp', kwargs={'sid':snp.id}) }}">MACSNP{{"%02d%02d%08d"|format(snp.individual.id,snp.snp.chrom.id,snp.snp.id)}}</a></td>
			<td>{{snp.snp.chrom.name}}: {{snp.snp.position}}</td>
			<td>{{snp.individual.code}}</td>
			<td>{{snp.snp.reference}}</td>
			<td>{{snp.snp.alteration}}</td>
			<td>{{snp.get_genotype_display()}}</td>
		</tr>
		{% endfor %}
	</tbody>
	<tfoot>
		<tr><th colspan="6">
		<div class="ui pager right floated pagination menu">
			{% if snps.has_previous() %}
			<a class="icon item" data-num="{{ snps.previous_page_number() }}">
				<i class="left chevron icon"></i>
			</a>
			{% endif %}

			{% for i in range(3, 0, -1) %}
			{% if snps.number - i > 0 %}
			<a class="item" data-num="{{snps.number-i}}">{{snps.number-i}}</a>
			{% endif %}
			{% endfor %}
			<a class="item active" data-num="{{snps.number}}">{{snps.number}}</a>
			{% for i in range(1, 4) %}
			{% if snps.number + i <= snps.paginator.num_pages %}
			<a class="item" data-num="{{snps.number+i}}">{{snps.number+i}}</a>
			{% endif %}
			{% endfor %}

			{% for i in page_range %}
			<a class="item {% if i == snps.number %} active {% endif %}" data-num="{{i}}">{{ i }}</a>
			{% endfor %}

			{% if snps.has_next() %}
			<a class="icon item" data-num="{{ snps.next_page_number() }}">
				<i class="right chevron icon"></i>
			</a>
			{% endif %}
		</div>
	</th></tr>
	</tfoot>
</table>

{% endblock %}
